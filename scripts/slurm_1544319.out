INFO:cmdstanpy:found newer exe file, not recompiling
INFO:cmdstanpy:compiled model file: /mnt/ceph/users/djin/git/q2-differential/q2_differential/assets/disease_single
Namespace(biom_table='/mnt/home/djin/ceph/snakemake/data/Dan2020ASD_rl150/Dan2020ASD.biom', chains=4, control_group='Healthy', groups='Status', metadata_file='/mnt/home/djin/ceph/snakemake/data/Dan2020ASD_rl150/sample_metadata_JM_new.txt', monte_carlo_samples=1000, output_inference='/mnt/home/djin/ceph/snakemake/data/Dan2020ASD_rl150/Dan2020ASD.nc', processes=1)
INFO:cmdstanpy:found newer exe file, not recompiling
INFO:cmdstanpy:compiled model file: /mnt/ceph/users/djin/git/q2-differential/q2_differential/assets/disease_single
INFO:cmdstanpy:start chain 1
INFO:cmdstanpy:start chain 2
INFO:cmdstanpy:start chain 3
INFO:cmdstanpy:start chain 4
INFO:cmdstanpy:finish chain 4
INFO:cmdstanpy:finish chain 3
INFO:cmdstanpy:finish chain 2
INFO:cmdstanpy:finish chain 1
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
WARNING:cmdstanpy:Property "stan_vars_cols" has been deprecated, use "metadata.stan_vars_cols" instead.
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "disease_parallel.py", line 60, in _single_func
    return m.to_inference_object()
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/birdman/model_base.py", line 264, in to_inference_object
    inference = single_feature_fit_to_inference(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/birdman/model_util.py", line 105, in single_feature_fit_to_inference
    feat_inf = az.from_cmdstanpy(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/io_cmdstanpy.py", line 813, in from_cmdstanpy
    return CmdStanPyConverter(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/io_cmdstanpy.py", line 441, in to_inference_data
    "posterior": self.posterior_to_xarray(),
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/base.py", line 65, in wrapped
    return func(cls)
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/io_cmdstanpy.py", line 130, in posterior_to_xarray
    dict_to_dataset(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/base.py", line 303, in dict_to_dataset
    data_vars[key] = numpy_to_data_array(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/base.py", line 249, in numpy_to_data_array
    coords = {key: xr.IndexVariable((key,), data=coords[key]) for key in dims}
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/base.py", line 249, in <dictcomp>
    coords = {key: xr.IndexVariable((key,), data=coords[key]) for key in dims}
KeyError: 'disease_ids'
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "disease_parallel.py", line 64, in <module>
    for inf in p.imap(_single_func, models, chunksize=50):
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/multiprocessing/pool.py", line 420, in <genexpr>
    return (item for chunk in result for item in chunk)
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/multiprocessing/pool.py", line 868, in next
    raise value
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "disease_parallel.py", line 60, in _single_func
    return m.to_inference_object()
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/birdman/model_base.py", line 264, in to_inference_object
    inference = single_feature_fit_to_inference(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/birdman/model_util.py", line 105, in single_feature_fit_to_inference
    feat_inf = az.from_cmdstanpy(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/io_cmdstanpy.py", line 813, in from_cmdstanpy
    return CmdStanPyConverter(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/io_cmdstanpy.py", line 441, in to_inference_data
    "posterior": self.posterior_to_xarray(),
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/base.py", line 65, in wrapped
    return func(cls)
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/io_cmdstanpy.py", line 130, in posterior_to_xarray
    dict_to_dataset(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/base.py", line 303, in dict_to_dataset
    data_vars[key] = numpy_to_data_array(
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/base.py", line 249, in numpy_to_data_array
    coords = {key: xr.IndexVariable((key,), data=coords[key]) for key in dims}
  File "/mnt/home/djin/miniconda3/envs/birdman3.8/lib/python3.8/site-packages/arviz/data/base.py", line 249, in <dictcomp>
    coords = {key: xr.IndexVariable((key,), data=coords[key]) for key in dims}
KeyError: 'disease_ids'
deleting tmpfiles dir: /tmp/tmpua0o_9dy
done
